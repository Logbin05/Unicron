syntax = "proto3";
package finance;

import "google/protobuf/timestamp.proto";

message BuyHistory {
  int64 bh_id = 1;
  int64 user_id = 2;
  int64 service_id = 3;
  double amount = 4;
  string currency = 5;
  string payment_provider = 6;
  string provider_payment_id = 7;
  google.protobuf.Timestamp created_at = 8;
}

message Basket {
  int64 basket_id = 1;
  int64 user_id = 2;
  int64 service_id = 3;
  google.protobuf.Timestamp added_at = 4;
}

service BuyHistoryService {
  rpc CreateBuyRecord(CreateBuyReq) returns (BuyHistory);
  rpc GetBuyRecord(GetBuyReq) returns (BuyHistory);
  rpc ListBuyHistory(ListBuyReq) returns (ListBuyRes);
}

service BasketService {
  rpc AddToBasket(AddToBasketReq) returns (Basket);
  rpc RemoveFromBasket(RemoveFromBasketReq) returns (RemoveFromBasketRes);
  rpc ListBasket(ListBasketReq) returns (ListBasketRes);
  rpc ClearBasket(ClearBasketReq) returns (ClearBasketRes);
}

message CreateBuyReq {
  int64 user_id = 1;
  int64 service_id = 2;
  double amount = 3;
  string currency = 4;
  string payment_provider = 5;
  string provider_payment_id = 6;
}
message GetBuyReq { int64 bh_id = 1; }
message ListBuyReq {
  int64 user_id = 1;
  int32 limit = 2;
  int32 offset = 3;
}
message ListBuyRes { repeated BuyHistory items = 1; }

message AddToBasketReq {
  int64 user_id = 1;
  int64 service_id = 2;
}
message RemoveFromBasketReq {
  int64 basket_id = 1;
}
message RemoveFromBasketRes { bool success = 1; }
message ListBasketReq { int64 user_id = 1; }
message ListBasketRes { repeated Basket items = 1; }
message ClearBasketReq { int64 user_id = 1; }
message ClearBasketRes { bool success = 1; }
